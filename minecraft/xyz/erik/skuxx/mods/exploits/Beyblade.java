package xyz.erik.skuxx.mods.exploits;

import net.minecraft.network.play.client.C0BPacketEntityAction;
import xyz.erik.api.mod.Mod;
import xyz.erik.skuxx.Skuxx;
import xyz.erik.skuxx.event.Event;
import xyz.erik.skuxx.event.EventTarget;
import xyz.erik.skuxx.event.events.EventMotion;
import xyz.erik.skuxx.mods.Category;

public class Beyblade
extends Mod{

    public Beyblade() {
        setCategory(Category.EXPLOITS);
    }

    private int yaw;
    @EventTarget
    private void onMotion(EventMotion eventMotion) {
        if (eventMotion.getMotion() == Event.Motion.BEFORE) {
            yaw += 8;
            eventMotion.setRotationYaw(yaw);
            if (this.yaw >= 360) {
                this.yaw = 0;

            }
        }

        if (!Skuxx.getInstance().getModManager().getMod("Sneakers").getState()) {
            if (eventMotion.getMotion() == Event.Motion.BEFORE) {
                if (getPlayer().MovementInput()) {
                    getPlayer().sendQueue.addToSendQueue(new C0BPacketEntityAction(getPlayer(), C0BPacketEntityAction.Action.STOP_SNEAKING));
                }
            } else if(eventMotion.getMotion() == Event.Motion.AFTER) {
                getPlayer().sendQueue.addToSendQueue(new C0BPacketEntityAction(getPlayer(), C0BPacketEntityAction.Action.START_SNEAKING));
                 setRunning(2);
            }
        }
    }

    public void onDisabled() {
        if (!Skuxx.getInstance().getModManager().getMod("Sneakers").getState()) {
            getPlayer().sendPacket(new C0BPacketEntityAction(getPlayer(),C0BPacketEntityAction.Action.STOP_SNEAKING));
        }
        super.onDisabled();
    }
}