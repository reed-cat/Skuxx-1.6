package xyz.erik.skuxx.mods.exploits;

import net.minecraft.entity.player.EntityPlayer;
import xyz.erik.api.helpers.ErikTimer;
import xyz.erik.api.helpers.Helper;
import xyz.erik.api.helpers.Location;
import xyz.erik.api.mod.Mod;
import xyz.erik.skuxx.event.Event;
import xyz.erik.skuxx.event.EventTarget;
import xyz.erik.skuxx.event.events.EventMotion;

public class FakeAura
extends Mod{

    public FakeAura() {

    }

    private ErikTimer timer = new ErikTimer();

    @EventTarget
    private void onMotino(EventMotion e) {
        if (e.getMotion() == Event.Motion.BEFORE) {
            EntityPlayer target = getEntity();
            if (target != null)
            {
                float[] rotations = Helper.getRotationsAtLocation(Location.HEAD,target);
                e.setRotationYaw(rotations[0]);
                e.setRotationPitch(rotations[1]);

                if (timer.delay(1000 / 6)) {
                    getPlayer().swingItem();
                    timer.reset();
                }
            }
        }

    }

    private EntityPlayer getEntity() {
        double dist =9999999;
        EntityPlayer player = null;
        for (Object o : getWorld().playerEntities)
        {
            EntityPlayer p = (EntityPlayer)o;
            if (p == null || p == getPlayer()) {
                continue;
            }
            if (p.getDistanceToEntity(getPlayer())> 5) {
                continue;
            }
            if (!p.isEntityAlive()) {
                continue;
            }
            if (p.getDistanceToEntity(getPlayer()) < dist)
            {
                player = p;
                dist = p.getDistanceToEntity(getPlayer());
            }
        }
        return player;
    }

}


