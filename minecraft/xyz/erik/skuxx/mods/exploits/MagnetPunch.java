package xyz.erik.skuxx.mods.exploits;

import net.minecraft.entity.Entity;
import net.minecraft.network.play.client.C02PacketUseEntity;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C0BPacketEntityAction;
import xyz.erik.api.mod.Mod;
import xyz.erik.api.notification.Notification;
import xyz.erik.api.notification.NotificationManager;
import xyz.erik.skuxx.event.EventTarget;
import xyz.erik.skuxx.event.events.EventPacket;

public class MagnetPunch
extends Mod{


    @EventTarget
    private void onPacketSend(EventPacket event) {
        if(event.getType() == EventPacket.Type.SEND) {
            if(event.getPacket() instanceof C02PacketUseEntity) {
                C02PacketUseEntity packet = (C02PacketUseEntity)event.getPacket();
                if (packet.getAction() == C02PacketUseEntity.Action.ATTACK) {
                    Entity entity = getWorld().getEntityByID(packet.entityId);
                    if (entity != getPlayer() && entity.getDistanceToEntity(getPlayer()) < 4) {
                    boolean oldSprint = getPlayer().isSprinting();
                            getPlayer().sendPacket(new C0BPacketEntityAction(getPlayer(),C0BPacketEntityAction.Action.STOP_SPRINTING));
                        getPlayer().sendPacket(new C0BPacketEntityAction(getPlayer(),C0BPacketEntityAction.Action.START_SPRINTING));


                        getPlayer().setSprinting(oldSprint);
                    }
                    }
                }

        }
    }

}

